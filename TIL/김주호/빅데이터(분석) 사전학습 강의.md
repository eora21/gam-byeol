# 빅데이터(분석) 사전학습 강의

> 정리: 6기 대전 김주호



- scale-out
  - 다수의 값싼 서버 사용
- scale-up
  - 소수의 값비싼 서버 사용
- 데이터 중심 어플리케이션 분야는 scale-out 선호
  - 가격과 성능은 비례하지 않음! 같은 가격이라면 여러 대가 성능이 낫다



## 데이터 중심 프로세싱 With 맵리듀스(MapReduce) 프레임워크

- 한 대의 컴퓨터로는 처리가 어려움, 다수의 컴퓨터를 묶어 처리해야 함
- `맵리듀스(MapReduce) 프레임 워크`가 해당 작업을 처리한다
  - 빅데이터를 이용하여 효율적 계산이 가능한 첫 번째 프로그래밍 모델
  - 기존 병렬 컴퓨팅은 프로그래머가 낮은 레벨의 시스템 세부사항까지 다 숙지했어야 함
- 빅데이터를 처리하기 위한 스케일러블(scalable) 병렬 소프트웨어 구현을 손쉽게 도와주는 간단한 프로그래밍 모델, 클러스터는 값싼 컴퓨터들로
  - 스케일러블(scalable): 사용자수 또는 데이터가 급증해도 프로그램이 멈추거나 성능이 떨어지지 않도록
- 드라이버에 해당하는 메인 함수가 맵(map) 함수와 리듀스(Reduce) 함수를 호출하여 처리
  - map: 반복문을 돌며 배열 안의 요소들을 1대 1로 짝지어줌, 기존 객체를 수정하지 않음
  - Reduce: 누적값을 이용한다는 특징이 있음, map, filter, sort등의 역할이 다 가능
- 각각의 레코드(record) 또는 튜플(tuple)은 key-value 쌍으로 표시됨
- `메인 함수`는 한 개의 마스터 머신에서 수행, map 전처리 또는 reduce 후처리 가능
- `컴퓨팅`은 맵과 리듀스가 한 쌍으로 이루어진 맵리듀스 페이즈를 수행
- `맵리듀스 페이즈`는 맵 함수 호출 -> (컴바인 함수 수행) -> 리듀스 함수 호출로 이루어짐
- 드라이버에 해당하는 메인 프로그램에서 맵리듀스 페이즈를 제어



### 맵리듀스 페이즈

#### 맵 페이즈

- 제일 먼저 수행, 데이터의 여러 파티션에 병렬 분산으로 호출되어 수행
- 각 머신마다 수행된 Mapper는 입력 데이터의 한 줄마다 맵 함수 호출
- 맵 함수는 key-value 쌍 형태로 결과를 출력하고 여러 머신에 나누어 보냄. 단, 같은 키를 가진 key-value 쌍은 같은 머신으로 보내짐

#### 셔플링 페이즈

- 모든 머신에서 맵 페이즈가 끝나면 시작
- 맵 페이즈에서 각각의 머신으로 보내진 key-value 쌍을 key로 정렬 후 key-valuelist형태로 만든 후 여러 머신에 분산

#### 리듀스 페이즈

- 모든 머신에서 셔플링 페이즈가 끝나면 각각의 머신마다 시작
- key-valuelist 쌍마다 리듀스 함수가 호출
- 출력이 있다면 key-value 쌍 형태로 출력



## Hadoop

### 하둡 분산 파일 시스템(HDFS)

- 빅 데이터 파일을 여러 개의 순차적 블록으로 구성 후 여러 대의 컴퓨터에 나누어 저장
- 한 파일의 각각 블록은 `폴트 톨러런스`를 위해 여러 개로 복사되어 머신 곳곳에 저장됨
  - 시스템을 구성하는 부품의 일부에서 결함 또는 고장이 발생하여도 정상적 혹은 부분적으로 기능을 수행할 수 있는 것
- 빅 데이터를 수천 대의 값싼 컴퓨터에 병렬 처리하기 위해 분산



### 주요 구성 요소들

- 맵리듀스 - 소프트웨어의 수행 분산
- HDFS - 데이터를 분산
- Namenode - 파일 시스템을 관리하고 클라이언트가 파일에 접근 가능
- Datanode - 컴퓨터에 들어있는 데이터 접근 가능



### 맵리듀스 함수 in Hadoop

#### 맵 함수

- org.apache.hadoop.mapreduce 패키지 내 Mapper 클래스 상속, 맵 메소드 수정
- 입력 텍스트 파일에서 라인 단위로 호출, 입력은 키-밸류리스트 형태
- 키는 입력 텍스트 파일에서 맨 앞 문자를 기준으로 맵 함수가 호출된 해당 라인 첫번째 문자까지의 오프셋
- 밸류는 텍스트의 해당 라인 전체

#### 리듀스 함수

- org.apache.hadoop.mapreduce 패키지 내 Reducer 클래스 상속, 리듀스 메소드 수정
- 셔플링 페이즈 출력을 키-밸류리스트 형태의 입력으로 받음

#### 컴바인 함수

- 리듀스 함수와 유사, 각 머신 맵 페이즈에서 맵 함수의 출력 크기를 줄여 셔플링 페이즈와 리듀스 페이즈의 비용을 줄임, 네트웍 트래픽 감소
- 맵함수의 결과 크기를 줄여줌
- 각각 머신에서 리듀스 함수를 이용하는 것처럼 수행
- 셔플링 비용을 줄여줌
- 맵리듀스 알고리즘 디자인에서 사용하는 것이 좋음

#### Mapper, Reducer

- 각 머신에서 독립적으로 수행
- 맵 함수, 리듀스 함수 수행